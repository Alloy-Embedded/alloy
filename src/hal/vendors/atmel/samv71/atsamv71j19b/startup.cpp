/// Auto-generated startup code for ATSAMV71J19B
/// Generated by Alloy Code Generator from CMSIS-SVD
///
/// Device:  ATSAMV71J19B
/// Vendor:  Microchip Technology
/// Family:  samv71
/// CPU:     CM7
///
/// DO NOT EDIT - Regenerate from SVD if needed

#include <cstdint>
#include <cstring>

// ============================================================================
// LINKER SCRIPT SYMBOLS
// ============================================================================

extern uint32_t _sidata;  // Start of .data section in flash
extern uint32_t _sdata;   // Start of .data section in RAM
extern uint32_t _edata;   // End of .data section in RAM
extern uint32_t _sbss;    // Start of .bss section
extern uint32_t _ebss;    // End of .bss section
extern uint32_t _estack;  // Stack top (defined in linker script)

// ============================================================================
// USER APPLICATION
// ============================================================================

extern "C" int main();

// System initialization (weak, can be overridden by user)
extern "C" void SystemInit() __attribute__((weak));
extern "C" void SystemInit() {}

// ============================================================================
// INTERRUPT HANDLERS
// ============================================================================

// Default handler for unhandled interrupts
extern "C" [[noreturn]] void Default_Handler() {
    // Trap - infinite loop if an unhandled interrupt occurs
    while (true) {
        __asm__ volatile("nop");
    }
}

// All interrupt handlers (weak, can be overridden by user)
extern "C" void SUPC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void RSTC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void RTC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void RTT_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void WDT_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PMC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void EFC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void UART0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void UART1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PIOA_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PIOB_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void USART0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void USART1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PIOD_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TWIHS0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TWIHS1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SSC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TC0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TC1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TC2_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TC3_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TC4_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TC5_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void AFEC0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void DACC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PWM0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void ICM_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void ACC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void USBHS_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void MCAN0_INT0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void MCAN0_INT1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void GMAC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void AFEC1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void QSPI_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void UART2_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TC6_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TC7_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TC8_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TC9_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TC10_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TC11_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void MLB_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void AES_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TRNG_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void XDMAC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void ISI_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PWM1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void FPU_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void RSWDT_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void CCW_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void CCF_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void GMAC_Q1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void GMAC_Q2_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void IXC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void GMAC_Q3_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void GMAC_Q4_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void GMAC_Q5_Handler() __attribute__((weak, alias("Default_Handler")));

// ============================================================================
// RESET HANDLER
// ============================================================================

extern "C" [[noreturn]] void Reset_Handler() {
    // 1. Copy initialized data from Flash to RAM (.data section)
    uint32_t* src = &_sidata;
    uint32_t* dest = &_sdata;
    while (dest < &_edata) {
        *dest++ = *src++;
    }

    // 2. Zero-initialize uninitialized data (.bss section)
    dest = &_sbss;
    while (dest < &_ebss) {
        *dest++ = 0;
    }

    // 3. Call system initialization (clock setup, etc.)
    SystemInit();

    // 4. Call C++ static constructors
    extern void (*__init_array_start[])();
    extern void (*__init_array_end[])();
    for (auto ctor = __init_array_start; ctor < __init_array_end; ++ctor) {
        (*ctor)();
    }

    // 5. Call main application
    main();

    // 6. If main returns, loop forever
    while (true) {
        __asm__ volatile("nop");
    }
}

// ============================================================================
// VECTOR TABLE
// ============================================================================

__attribute__((section(".isr_vector"), used))
void (* const vector_table[])() = {
    // Core system handlers
    reinterpret_cast<void (*)()>(&_estack),  // Initial stack pointer
    Reset_Handler,                            // Reset handler
    SUPC_Handler,                  // IRQ 0: SUPC
    RSTC_Handler,                  // IRQ 1: RSTC
    RTC_Handler,                   // IRQ 2: RTC
    RTT_Handler,                   // IRQ 3: RTT
    WDT_Handler,                   // IRQ 4: WDT
    PMC_Handler,                   // IRQ 5: PMC
    EFC_Handler,                   // IRQ 6: EFC
    UART0_Handler,                 // IRQ 7: UART0
    UART1_Handler,                 // IRQ 8: UART1
    PIOA_Handler,                  // IRQ 10: PIOA
    PIOB_Handler,                  // IRQ 11: PIOB
    USART0_Handler,                // IRQ 13: USART0
    USART1_Handler,                // IRQ 14: USART1
    PIOD_Handler,                  // IRQ 16: PIOD
    TWIHS0_Handler,                // IRQ 19: TWIHS0
    TWIHS1_Handler,                // IRQ 20: TWIHS1
    SSC_Handler,                   // IRQ 22: SSC
    TC0_Handler,                   // IRQ 23: TC0
    TC1_Handler,                   // IRQ 24: TC1
    TC2_Handler,                   // IRQ 25: TC2
    TC3_Handler,                   // IRQ 26: TC3
    TC4_Handler,                   // IRQ 27: TC4
    TC5_Handler,                   // IRQ 28: TC5
    AFEC0_Handler,                 // IRQ 29: AFEC0
    DACC_Handler,                  // IRQ 30: DACC
    PWM0_Handler,                  // IRQ 31: PWM0
    ICM_Handler,                   // IRQ 32: ICM
    ACC_Handler,                   // IRQ 33: ACC
    USBHS_Handler,                 // IRQ 34: USBHS
    MCAN0_INT0_Handler,            // IRQ 35: MCAN0_INT0
    MCAN0_INT1_Handler,            // IRQ 36: MCAN0_INT1
    GMAC_Handler,                  // IRQ 39: GMAC
    AFEC1_Handler,                 // IRQ 40: AFEC1
    QSPI_Handler,                  // IRQ 43: QSPI
    UART2_Handler,                 // IRQ 44: UART2
    TC6_Handler,                   // IRQ 47: TC6
    TC7_Handler,                   // IRQ 48: TC7
    TC8_Handler,                   // IRQ 49: TC8
    TC9_Handler,                   // IRQ 50: TC9
    TC10_Handler,                  // IRQ 51: TC10
    TC11_Handler,                  // IRQ 52: TC11
    MLB_Handler,                   // IRQ 53: MLB
    AES_Handler,                   // IRQ 56: AES
    TRNG_Handler,                  // IRQ 57: TRNG
    XDMAC_Handler,                 // IRQ 58: XDMAC
    ISI_Handler,                   // IRQ 59: ISI
    PWM1_Handler,                  // IRQ 60: PWM1
    FPU_Handler,                   // IRQ 61: FPU
    RSWDT_Handler,                 // IRQ 63: RSWDT
    CCW_Handler,                   // IRQ 64: CCW
    CCF_Handler,                   // IRQ 65: CCF
    GMAC_Q1_Handler,               // IRQ 66: GMAC_Q1
    GMAC_Q2_Handler,               // IRQ 67: GMAC_Q2
    IXC_Handler,                   // IRQ 68: IXC
    GMAC_Q3_Handler,               // IRQ 71: GMAC_Q3
    GMAC_Q4_Handler,               // IRQ 72: GMAC_Q4
    GMAC_Q5_Handler,               // IRQ 73: GMAC_Q5
};
