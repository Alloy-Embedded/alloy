/// Auto-generated startup code for ESP32-S2
/// Generated by Alloy Code Generator from CMSIS-SVD
///
/// Device:  ESP32-S2
/// Vendor:  ESPRESSIF SYSTEMS (SHANGHAI) CO., LTD.
/// Family:  esp32_s2
/// CPU:     Xtensa LX7
///
/// DO NOT EDIT - Regenerate from SVD if needed

#include <cstdint>
#include <cstring>

// ============================================================================
// LINKER SCRIPT SYMBOLS
// ============================================================================

extern uint32_t _sidata;  // Start of .data section in flash
extern uint32_t _sdata;   // Start of .data section in RAM
extern uint32_t _edata;   // End of .data section in RAM
extern uint32_t _sbss;    // Start of .bss section
extern uint32_t _ebss;    // End of .bss section
extern uint32_t _estack;  // Stack top (defined in linker script)

// ============================================================================
// USER APPLICATION
// ============================================================================

extern "C" int main();

// System initialization (weak, can be overridden by user)
extern "C" void SystemInit() __attribute__((weak));
extern "C" void SystemInit() {}

// ============================================================================
// INTERRUPT HANDLERS
// ============================================================================

// Default handler for unhandled interrupts
extern "C" [[noreturn]] void Default_Handler() {
    // Trap - infinite loop if an unhandled interrupt occurs
    while (true) {
        __asm__ volatile("nop");
    }
}

// All interrupt handlers (weak, can be overridden by user)
extern "C" void WIFI_MAC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void WIFI_NMI_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void WIFI_PWR_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void WIFI_BB_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void BT_MAC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void BT_BB_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void BT_BB_NMI_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void RWBT_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void RWBLE_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void RWBT_NMI_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void RWBLE_NMI_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SLC0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SLC1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void UHCI0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void UHCI1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG0_T0_LEVEL_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG0_T1_LEVEL_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG0_WDT_LEVEL_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG0_LACT_LEVEL_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG1_T0_LEVEL_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG1_T1_LEVEL_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG1_WDT_LEVEL_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG1_LACT_LEVEL_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void GPIO_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void GPIO_NMI_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void GPIO_INTR_2_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void GPIO_NMI_2_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void DEDICATED_GPIO_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void FROM_CPU_INTR0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void FROM_CPU_INTR1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void FROM_CPU_INTR2_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void FROM_CPU_INTR3_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SPI1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SPI2_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SPI3_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void I2S0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void I2S1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void UART0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void UART1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void UART2_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SDIO_HOST_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void LEDC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void EFUSE_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TWAI0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void USB_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void RTC_CORE_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void RMT_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PCNT_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void I2C_EXT0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void I2C_EXT1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void RSA_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SHA_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void AES_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SPI2_DMA_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SPI3_DMA_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void WDT_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TIMER1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TIMER2_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG0_T0_EDGE_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG0_T1_EDGE_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG0_WDT_EDGE_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG0_LACT_EDGE_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG1_T0_EDGE_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG1_T1_EDGE_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG1_WDT_EDGE_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void TG1_LACT_EDGE_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void CACHE_IA_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SYSTIMER_TARGET0_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SYSTIMER_TARGET1_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SYSTIMER_TARGET2_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PMS_PRO_IRAM0_ILG_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PMS_PRO_DRAM0_ILG_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PMS_PRO_DPORT_ILG_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PMS_PRO_AHB_ILG_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PMS_PRO_CACHE_ILG_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PMS_DMA_APB_I_ILG_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PMS_DMA_RX_I_ILG_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void PMS_DMA_TX_I_ILG_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SPI0_REJECT_CACHE_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SPI4_DMA_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void SPI4_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void ICACHE_PRELOAD_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void DCACHE_PRELOAD_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void APB_ADC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void CPU_PERI_ERR_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void APB_PERI_ERR_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void DCACHE_SYNC_Handler() __attribute__((weak, alias("Default_Handler")));
extern "C" void ICACHE_SYNC_Handler() __attribute__((weak, alias("Default_Handler")));

// ============================================================================
// RESET HANDLER
// ============================================================================

extern "C" [[noreturn]] void Reset_Handler() {
    // 1. Copy initialized data from Flash to RAM (.data section)
    uint32_t* src = &_sidata;
    uint32_t* dest = &_sdata;
    while (dest < &_edata) {
        *dest++ = *src++;
    }

    // 2. Zero-initialize uninitialized data (.bss section)
    dest = &_sbss;
    while (dest < &_ebss) {
        *dest++ = 0;
    }

    // 3. Call system initialization (clock setup, etc.)
    SystemInit();

    // 4. Call C++ static constructors
    extern void (*__init_array_start[])();
    extern void (*__init_array_end[])();
    for (auto ctor = __init_array_start; ctor < __init_array_end; ++ctor) {
        (*ctor)();
    }

    // 5. Call main application
    main();

    // 6. If main returns, loop forever
    while (true) {
        __asm__ volatile("nop");
    }
}

// ============================================================================
// VECTOR TABLE
// ============================================================================

__attribute__((section(".isr_vector"), used))
void (* const vector_table[])() = {
    // Core system handlers
    reinterpret_cast<void (*)()>(&_estack),  // Initial stack pointer
    Reset_Handler,                            // Reset handler
    WIFI_MAC_Handler,              // IRQ 0: WIFI_MAC
    WIFI_NMI_Handler,              // IRQ 1: WIFI_NMI
    WIFI_PWR_Handler,              // IRQ 2: WIFI_PWR
    WIFI_BB_Handler,               // IRQ 3: WIFI_BB
    BT_MAC_Handler,                // IRQ 4: BT_MAC
    BT_BB_Handler,                 // IRQ 5: BT_BB
    BT_BB_NMI_Handler,             // IRQ 6: BT_BB_NMI
    RWBT_Handler,                  // IRQ 7: RWBT
    RWBLE_Handler,                 // IRQ 8: RWBLE
    RWBT_NMI_Handler,              // IRQ 9: RWBT_NMI
    RWBLE_NMI_Handler,             // IRQ 10: RWBLE_NMI
    SLC0_Handler,                  // IRQ 11: SLC0
    SLC1_Handler,                  // IRQ 12: SLC1
    UHCI0_Handler,                 // IRQ 13: UHCI0
    UHCI1_Handler,                 // IRQ 14: UHCI1
    TG0_T0_LEVEL_Handler,          // IRQ 15: TG0_T0_LEVEL
    TG0_T1_LEVEL_Handler,          // IRQ 16: TG0_T1_LEVEL
    TG0_WDT_LEVEL_Handler,         // IRQ 17: TG0_WDT_LEVEL
    TG0_LACT_LEVEL_Handler,        // IRQ 18: TG0_LACT_LEVEL
    TG1_T0_LEVEL_Handler,          // IRQ 19: TG1_T0_LEVEL
    TG1_T1_LEVEL_Handler,          // IRQ 20: TG1_T1_LEVEL
    TG1_WDT_LEVEL_Handler,         // IRQ 21: TG1_WDT_LEVEL
    TG1_LACT_LEVEL_Handler,        // IRQ 22: TG1_LACT_LEVEL
    GPIO_Handler,                  // IRQ 23: GPIO
    GPIO_NMI_Handler,              // IRQ 24: GPIO_NMI
    GPIO_INTR_2_Handler,           // IRQ 25: GPIO_INTR_2
    GPIO_NMI_2_Handler,            // IRQ 26: GPIO_NMI_2
    DEDICATED_GPIO_Handler,        // IRQ 27: DEDICATED_GPIO
    FROM_CPU_INTR0_Handler,        // IRQ 28: FROM_CPU_INTR0
    FROM_CPU_INTR1_Handler,        // IRQ 29: FROM_CPU_INTR1
    FROM_CPU_INTR2_Handler,        // IRQ 30: FROM_CPU_INTR2
    FROM_CPU_INTR3_Handler,        // IRQ 31: FROM_CPU_INTR3
    SPI1_Handler,                  // IRQ 32: SPI1
    SPI2_Handler,                  // IRQ 33: SPI2
    SPI3_Handler,                  // IRQ 34: SPI3
    I2S0_Handler,                  // IRQ 35: I2S0
    I2S1_Handler,                  // IRQ 36: I2S1
    UART0_Handler,                 // IRQ 37: UART0
    UART1_Handler,                 // IRQ 38: UART1
    UART2_Handler,                 // IRQ 39: UART2
    SDIO_HOST_Handler,             // IRQ 40: SDIO_HOST
    LEDC_Handler,                  // IRQ 45: LEDC
    EFUSE_Handler,                 // IRQ 46: EFUSE
    TWAI0_Handler,                 // IRQ 47: TWAI0
    USB_Handler,                   // IRQ 48: USB
    RTC_CORE_Handler,              // IRQ 49: RTC_CORE
    RMT_Handler,                   // IRQ 50: RMT
    PCNT_Handler,                  // IRQ 51: PCNT
    I2C_EXT0_Handler,              // IRQ 52: I2C_EXT0
    I2C_EXT1_Handler,              // IRQ 53: I2C_EXT1
    RSA_Handler,                   // IRQ 54: RSA
    SHA_Handler,                   // IRQ 55: SHA
    AES_Handler,                   // IRQ 56: AES
    SPI2_DMA_Handler,              // IRQ 57: SPI2_DMA
    SPI3_DMA_Handler,              // IRQ 58: SPI3_DMA
    WDT_Handler,                   // IRQ 59: WDT
    TIMER1_Handler,                // IRQ 60: TIMER1
    TIMER2_Handler,                // IRQ 61: TIMER2
    TG0_T0_EDGE_Handler,           // IRQ 62: TG0_T0_EDGE
    TG0_T1_EDGE_Handler,           // IRQ 63: TG0_T1_EDGE
    TG0_WDT_EDGE_Handler,          // IRQ 64: TG0_WDT_EDGE
    TG0_LACT_EDGE_Handler,         // IRQ 65: TG0_LACT_EDGE
    TG1_T0_EDGE_Handler,           // IRQ 66: TG1_T0_EDGE
    TG1_T1_EDGE_Handler,           // IRQ 67: TG1_T1_EDGE
    TG1_WDT_EDGE_Handler,          // IRQ 68: TG1_WDT_EDGE
    TG1_LACT_EDGE_Handler,         // IRQ 69: TG1_LACT_EDGE
    CACHE_IA_Handler,              // IRQ 70: CACHE_IA
    SYSTIMER_TARGET0_Handler,      // IRQ 71: SYSTIMER_TARGET0
    SYSTIMER_TARGET1_Handler,      // IRQ 72: SYSTIMER_TARGET1
    SYSTIMER_TARGET2_Handler,      // IRQ 73: SYSTIMER_TARGET2
    PMS_PRO_IRAM0_ILG_Handler,     // IRQ 75: PMS_PRO_IRAM0_ILG
    PMS_PRO_DRAM0_ILG_Handler,     // IRQ 76: PMS_PRO_DRAM0_ILG
    PMS_PRO_DPORT_ILG_Handler,     // IRQ 77: PMS_PRO_DPORT_ILG
    PMS_PRO_AHB_ILG_Handler,       // IRQ 78: PMS_PRO_AHB_ILG
    PMS_PRO_CACHE_ILG_Handler,     // IRQ 79: PMS_PRO_CACHE_ILG
    PMS_DMA_APB_I_ILG_Handler,     // IRQ 80: PMS_DMA_APB_I_ILG
    PMS_DMA_RX_I_ILG_Handler,      // IRQ 81: PMS_DMA_RX_I_ILG
    PMS_DMA_TX_I_ILG_Handler,      // IRQ 82: PMS_DMA_TX_I_ILG
    SPI0_REJECT_CACHE_Handler,     // IRQ 83: SPI0_REJECT_CACHE
    SPI4_DMA_Handler,              // IRQ 85: SPI4_DMA
    SPI4_Handler,                  // IRQ 86: SPI4
    ICACHE_PRELOAD_Handler,        // IRQ 87: ICACHE_PRELOAD
    DCACHE_PRELOAD_Handler,        // IRQ 88: DCACHE_PRELOAD
    APB_ADC_Handler,               // IRQ 89: APB_ADC
    CPU_PERI_ERR_Handler,          // IRQ 91: CPU_PERI_ERR
    APB_PERI_ERR_Handler,          // IRQ 92: APB_PERI_ERR
    DCACHE_SYNC_Handler,           // IRQ 93: DCACHE_SYNC
    ICACHE_SYNC_Handler,           // IRQ 94: ICACHE_SYNC
};
